import discord
import random
import asyncio
import keep_alive
import json
from discord.ext import commands

TOKEN = 'NzUwNDg3ODg1NjM0OTk0MzA4.X07QTw.TlzdMXpC-kPKUaugkiq-klC7rjk'

client = commands.Bot(command_prefix = ';')

class BotData:
  def __innit__(self):
    self.welcome_channel = None
    self.goodbye_channel = None
    
botdata = BotData()

@client.event
async def on_ready():
  await client.change_presence(status=discord.Status.online, activity=discord.Game(';mental'))
  print('Bot is ready. Les go.')
  
@client.event
async def on_command_error(ctx, error):
  if isinstance(error, commands.CommandNotFound):
    await ctx.send('Invalid command used.')
    
@client.event
async def on_member_join(member):
  if botdata.welcome_channel != None:
    await botdata.welcome_channel.send("Welcome {member.mention}, to the official ROBLOXExploiting Subreddit Discord! Make sure to read the rules!")
    await botdata.welcome_channel.send("https://tenor.com/view/yes-gif-18324720")
    
  else:
      print("Welcome Channel was not set.")

@client.event
async def on_member_leave(member):
  if botdata.goodbye_channel != None:
    await botdata.goodbye_channel.send("{member.mention} has just left us...")
    await botdata.goodbye_channel.send("https://tenor.com/view/yes-gif-18324720")
    
  else:
      print("Goodbye Channel was not set.")

@client.command
@commands.has_permissions(manage_channels=True)
async def welcome_channel(ctx, channel_name=None):
  if channel_name !=None:
    for channel in ctx.guild.channels:
      if channel.name == channel_name:
        botdata.welcome_channel = channel
        await ctx.channel.send (f"Welcome channel has been set to {channel.name}")
        await channel.send("This is the new Welcome Channel!")
    
    else:
        await ctx.channel.send("You did not include the Welcome Channel!")
  
  @client.command
  @commands.has_permissions(manage_channels=True)
  async def goodbye_channel(ctx, channel_name=None):
    if channel_name !=None:
      for channel in ctx.guild.channels:
        if channel.name == channel_name:
          botdata.goodbye_channel = channel
          await ctx.channel.send (f"Goodbyechannel has been set to {channel.name}")
          await channel.send("This is the new Goodbye Channel!")
    
    else:
        await ctx.channel.send("You did not include the Goodbye Channel!")
  
@client.command()
@commands.has_permissions(manage_messages=True)
async def clear(ctx, amount : int):
  await ctx.channel.purge(limit=amount+1)
  await ctx.send("Deleted the messages c:")
  
@clear.error
async def clear_error(ctx, error):
  if isinstance(error, commands.MissingRequiredArgument):
    await ctx.send('please specify an amount of messages to delete.')
    
@client.command()
async def gatherepiks(ctx):
  embed=discord.Embed(title = "Amount of Epiks Found:", description = (random.randint(0,100)), color = (0xF81000))
  await ctx.send(embed = embed)

@client.command(pass_context = True)
async def reddit(ctx):
  embed=discord.Embed(title = "Reddit", description = ('Reddit: https://www.reddit.com/r/ROBLOXExploiting/'), color = (0xF80900))
  await ctx.send(embed = embed)
  
@client.command(pass_context = True)
async def howgay(ctx):
  embed=discord.Embed(title = "How many same-gendered people do you like?", description = (random.randint(0, 100)), color = (0xF85252))
  await ctx.send(embed = embed)
  
@client.command(pass_context = True)
async def epicrate(ctx):
  embed=discord.Embed(title = "how much epiks r in u?", description = (random.randint(0, 100)), color = (0xF91000))
  await ctx.send(embed = embed)
  
@client.command()
async def mental(ctx):
  embed=discord.Embed(title = "Mental Help becuase I have no ideas left", description = ('Call 1-800-273-TALK (8255) to reach a 24-hour crisis center, text MHA to 741741, call 911, or go to the nearest emergency room. Find a local MHA affiliate who can provide services. Find a therapist. Find support groups.'), color = (0x59100))
  await ctx.send(embed = embed)
  
@client.command()
async def ad(ctx):
  await ctx.send('Hello! Welcome to the official Discord Server for the r/ROBLOXExploiting subreddit! What do we offer? We offer scripts, a chat, and a custom bot! So, why not join today? You may like it! https://discord.gg/qyXwhur')
  await ctx.send('https://tenor.com/view/yes-gif-18324720')
  
@client.command()
async def credits(ctx):
  await ctx.send('This bot was made by Ekstra#7336.')
  
@client.command(pass_context=True)
@commands.has_permissions(kick_members=True)
async def kick(ctx, member:discord.User=None, reason=None):
  if member == None or member == ctx.message.author:
    await ctx.channel.send("You cannot kick yourself.")
    return
  if reason == None:
    reason = "No reason"
  message = f"You have been kicked from {ctx.guild.name} for {reason}"
  await member.send(message)
  await ctx.guild.kick(member)
  await ctx.channel.send(f"{member} has been kicked.")
  await ctx.channel.send("https://tenor.com/view/fucked-bam-jackass-flying-kick-kick-gif-15175869")
@kick.error
async def kick_error(ctx, error):
  if isinstance(error, commands.CheckFailure):
    await ctx.send("You are not allowed to kick.")
    
  @bot.command(pass_context=True)
  @commands.has_permissions(ban_members=True)
  async def ban(ctx, member:discord.User=None, reason=None):
    if member == None or member == ctx.message.author:
      await ctx.channel.send("You cannot ban your self.")
    return
    if reason == None:
      reason = "No reason"
      message = f"You have been banned from {ctx.guild.name} for {reason}"
      await member.send(message)
      await ctx.guild.ban(member)
      await ctx.channel.send(f"{member} has been banned.")
      await ctx.channel.send("https://tenor.com/view/yoshi-hammer-ban-gif-9278385")
  @ban.error
  async def ban_error(ctx, error):
    if isinstance(error, commands.CheckFailure):
      await ctx.send("You are not allowed to ban.")
      
  @bot.command(pass_test=True)
  async def nuke(ctx, amount=10**10):
    if not ctx.author.permissions_in(ctx.channel).manage_messages:
      await ctx.send ("uh-oh! Looks like your missing permission to use that command!")
      return
    await ctx.channel.purge(limit=amount)
  await ctx.send('Channel Nuked!')
  await ctx.send('https://tenor.com/view/sans-undertale-nuke-badtime-gif-14092678')
  return
    
keep_alive.keep_alive()
    
client.run(TOKEN)
